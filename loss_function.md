### 손실 함수 (Loss Function)

- 손실 함수는 신경망에서 **나쁨**을 나타내는 지표로, 현재의 신경망이 훈련데이터를 얼마나 잘 처리하지 못하냐에 대한 지표입니다.

- 종류

  - 평균 제곱 오차 (Mean Square Error, MSE)
  - 교차 엔트로피 오차 (Cross Entropy Error, CEE)

- **평균 제곱 오차 (MSE)**

  - 식
    $$
    E = \frac{1}{2} \sum_{k}(y_k-t_k)^2
    $$

  - code

    ```python
    import numpy as np
    
    def mean_squared_error(y, t):
        return 0.5 * np.sum( (y-t)**2 )
    ```

  - t는 one-hot encoding으로 된 정답

  - y는 predict에서 출력한 예측 값

  - 정답과 예측값을 차이에 대한 제곱이 전체 평균 값을 사용

  - 정답과 다른 잘못된 값을 예측하면 당연히 error는 크기 때문에 MSE의 결과도 크다.

- **교체 엔트로피 오차 (CEE)**

  - 식
    $$
    E = -\sum_{k}t_k\log{y_k}
    $$

  - code

    ```python
    import numpy as np
    
    def cross_entropy_error(y, t):
        delta = 1e-7
        return -np.sum(t * np.log(y+delta))
    ```

  - t는 one-hot encoding으로 된 정답

  - t를 곱하기 때문에 정답이 아닌 값은 0으로 곱하여 사라진다.

  - 정답에 해당하는 one-hot encoding 위치만 1이기 때문에 해당 위치의 값이 절대적으로 크게 나타난다. 

  - 역시 Error에 대한 지표이기 때문에 예측결과가 틀리면 CEE의 결과도 크다.

- **손실 함수를 구하는 목적** (정확도를 학습 지표로 사용하지 않는 이유)

  - 이유는 신경망 학습에서 사용하는 미분에 있다.

  - 가중치의 최적의 매개변수값을 찾는데 손실 함수의 값을 가장 적게 하는 매개변수를 찾는다. 

  - 이 과정에서 매개변수의 미분(기울기)을 구한다. 이 미분값을 단서로 매개변수의 값을 서서히 갱신하는 과정을 반복한다.

  - 가령 어떤 신경망에서 특정 매개변수를 주목한다고 하자. 이때 그 가중치 매개변수의 손실 함수의 미분이란 '가중치 매개변수의 값을 변경했을 때 손실함수의 값이 어떻게 변하는가'의 의미이다.

  - 만약 이 미분값이 음수이면 그 가중치를 양의 방향으로 변화시켜 손실 함수의 값을 줄일 수 있다.

  - 반대로 그 미분값이 양수이면 가중치를 음의 방향으로 변화시켜 손실 함수의  값을 줄일 수 있다.

  - 만약 그 미분값이 0이 된다면 그 가중치는 어느방향으로 움직여도 손실 함수의 값은 달라지지 않는다. 그러면 그 가중치 매개변수의 갱신은 거기서 멈춘다.

  - > 정확도를 지표로 하면 매개변수의 미분이 대부분의 장소에서 0이 되기 때문에 정확도를 지표로 사용하면 안된다. 정확도는 매개변수의 미소한 변화에 대하여 거의 반응을 보이지 않고, 반응이 있더라도 그 값이 불연속적으로 갑자기 변화한다.